<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Greenfield Student Portal</title>
<meta name="theme-color" content="#FF7AC6">
<style>
:root{
  --bg:#fbfbff; --accent:#6c5ce7; --accent2:#ff7ac6; --card:#fff; --muted:#6b7280;
}
*{box-sizing:border-box;font-family:Inter,system-ui,Arial,Helvetica,sans-serif}
html,body{height:100%;margin:0;background:
  radial-gradient(1200px 400px at -10% 20%, rgba(108,92,231,0.06), transparent 10%),
  radial-gradient(1000px 300px at 110% 80%, rgba(255,122,198,0.04), transparent 12%),
  var(--bg); color:#0b1220}
header{display:flex;align-items:center;justify-content:space-between;padding:12px 18px;background:linear-gradient(180deg,var(--card),#f6f7ff);box-shadow:0 6px 18px rgba(11,17,32,0.06);position:sticky;top:0;z-index:40}
.left{display:flex;align-items:center;gap:12px}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:18px;box-shadow:0 8px 20px rgba(108,92,231,0.18);cursor:pointer;user-select:none}
.school-title{font-weight:800;font-size:18px}
.school-sub{font-size:12px;color:var(--muted)}
.right{display:flex;align-items:center;gap:10px}
.teacher{font-size:13px;color:var(--muted);text-align:right}
.btn{padding:9px 12px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
.btn-primary{background:var(--accent);color:white;box-shadow:0 8px 18px rgba(108,92,231,0.12)}
.btn-ghost{background:transparent;border:1px solid rgba(11,17,32,0.06);color:var(--muted)}
main{max-width:1000px;margin:18px auto;padding:12px}
.card{background:var(--card);border-radius:12px;padding:14px;margin-bottom:14px;box-shadow:0 6px 18px rgba(11,17,32,0.04)}
.muted{color:var(--muted);font-size:13px}
.row{display:flex;gap:12px;flex-wrap:wrap}
#gamesPanel{display:none;margin-top:12px}
.games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}
.game-tile{background:linear-gradient(180deg,#fff,#fbfbff);border-radius:12px;padding:8px;text-align:center;border:1px solid rgba(11,17,32,0.04);cursor:pointer;transition:transform .12s}
.game-tile:hover{transform:translateY(-6px)}
.game-thumb{width:100%;height:92px;object-fit:cover;border-radius:8px}
.game-name{font-weight:800;margin-top:8px;color:#0b1220}
#playArea{display:none;margin-top:12px;padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#f7fbff);min-height:320px;border:1px solid rgba(11,17,32,0.04)}
.play-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.small{font-size:13px;color:var(--muted)}
.searchRow{display:flex;gap:8px;align-items:center}
.searchRow input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(11,17,32,0.06)}
.controls{display:flex;gap:8px;align-items:center}
footer{text-align:center;color:var(--muted);font-size:12px;margin:18px 0}
iframe.gameFrame{width:100%;height:600px;border:none;border-radius:8px;background:#000}
.hidden{display:none}
.homeworkScreen{padding:18px;background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(11,17,32,0.04)}
@media(max-width:520px){ .logo{width:48px;height:48px;font-size:16px} .game-thumb{height:76px} iframe.gameFrame{height:420px} }
</style>
</head>
<body>
<header>
  <div class="left">
    <div id="logo" class="logo" title="School logo">SCH</div>
    <div>
      <div class="school-title">Greenfield High — Student Portal</div>
      <div class="school-sub">Classroom Resources • Grade 10</div>
    </div>
  </div>

  <div class="right">
    <div class="teacher">
      <div style="font-weight:800">Ms. Park</div>
      <div class="small">Classroom Lead</div>
    </div>
    <button id="homeworkBtn" class="btn btn-ghost" title="Hide games fast">Homework</button>
    <button id="startActivity" class="btn btn-primary">Start Activity</button>
  </div>
</header>

<main>
  <section class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="font-weight:900">Practice Tools</div>
        <div class="muted">Triple-tap the logo to unlock the Activity Pack. Use Homework to hide quickly.</div>
      </div>
      <div style="text-align:right"><div style="display:inline-block;padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent2),var(--accent));color:white;font-weight:800">v2.0</div></div>
    </div>

    <!-- controls: search + music + hide -->
    <div style="margin-top:12px;display:flex;gap:12px;flex-wrap:wrap;align-items:center">
      <div class="searchRow" style="flex:1;min-width:220px">
        <input id="searchBox" placeholder="Search games (e.g. pizza, runner, wings, flappy)"/>
        <button id="searchClear" class="btn btn-ghost">Clear</button>
      </div>

      <div class="controls">
        <label style="display:flex;gap:6px;align-items:center" title="Upload audio file to use as background music">
          <input id="musicFile" type="file" accept="audio/*" style="display:none" />
          <button id="uploadMusic" class="btn btn-ghost">Upload Music</button>
        </label>
        <button id="musicToggle" class="btn btn-ghost hidden">Play Music</button>
        <button id="hideGames" class="btn btn-ghost">Hide (Homework)</button>
      </div>
    </div>

    <!-- Games panel (hidden until unlocked) -->
    <div id="gamesPanel" class="card" style="margin-top:14px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800">Activity Pack — Games</div>
        <div class="muted">Tap a tile to open a game inside the page</div>
      </div>

      <div id="gamesGrid" class="games-grid" style="margin-top:12px">
        <!-- Many tiles linking to popular Poki pages (and food/cooking pages) -->
        <!-- Food / Restaurant / Wing games -->
        <div class="game-tile" data-url="https://poki.com/en/g/crazy-restaurant"><img class="game-thumb" src="https://i.imgur.com/0oJkQ1R.jpg"><div class="game-name">Crazy Restaurant</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/papa-s-pizzeria"><img class="game-thumb" src="https://i.imgur.com/HV8Y1bE.jpeg"><div class="game-name">Papa's Pizzeria</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/papa-s-wingeria"><img class="game-thumb" src="https://i.imgur.com/9m7oY0U.jpeg"><div class="game-name">Wing Bar</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/cooking-fast-2"><img class="game-thumb" src="https://i.imgur.com/4qz1iQf.jpg"><div class="game-name">Cooking Fast</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/pancake-run"><img class="game-thumb" src="https://i.imgur.com/U5Xk6wP.jpeg"><div class="game-name">Pancake Run</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/burger-bounty"><img class="game-thumb" src="https://i.imgur.com/7l3W5Dx.jpg"><div class="game-name">Burger Maker</div></div>

        <!-- Arcade / runners / classics -->
        <div class="game-tile" data-url="https://poki.com/en/g/subway-surfers"><img class="game-thumb" src="https://i.imgur.com/3k8q0Si.jpg"><div class="game-name">Subway Surfers</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/temple-run-2"><img class="game-thumb" src="https://i.imgur.com/8m5b1s2.jpg"><div class="game-name">Temple Run 2</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/moto-x3m"><img class="game-thumb" src="https://i.imgur.com/o2Rzv8o.jpg"><div class="game-name">Moto X3M</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/snake-io"><img class="game-thumb" src="https://i.imgur.com/2r7QfJp.jpeg"><div class="game-name">Snake.io</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/2048"><img class="game-thumb" src="https://i.imgur.com/eD2mV1k.jpeg"><div class="game-name">2048</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/flappy-bird"><img class="game-thumb" src="https://i.imgur.com/7XcGf0K.jpeg"><div class="game-name">Flappy</div></div>

        <!-- more arcade / puzzle -->
        <div class="game-tile" data-url="https://poki.com/en/g/candy-crush"><img class="game-thumb" src="https://i.imgur.com/0b1jZ1T.jpg"><div class="game-name">Candy Pop</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/papa-s-scooperia"><img class="game-thumb" src="https://i.imgur.com/9xaKZB8.jpg"><div class="game-name">Ice Cream Shop</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/drag-racer-v3"><img class="game-thumb" src="https://i.imgur.com/VG3xkz3.jpg"><div class="game-name">Drag Racer</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/bubble-shooter"><img class="game-thumb" src="https://i.imgur.com/Lg2w5Qm.jpeg"><div class="game-name">Bubble Pop</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/basketbros-3d"><img class="game-thumb" src="https://i.imgur.com/4FJtXbB.jpg"><div class="game-name">Basket Bros</div></div>
        <div class="game-tile" data-url="https://poki.com/en/g/temple-run-2"><img class="game-thumb" src="https://i.imgur.com/8m5b1s2.jpg"><div class="game-name">Temple Runner</div></div>
      </div>
    </div>

    <div id="playArea" class="card">
      <div class="play-header">
        <div style="font-weight:900" id="playTitle">Ready</div>
        <div>
          <button id="closeGame" class="btn btn-ghost">Close</button>
        </div>
      </div>

      <div id="playInner" class="small">Select a game tile to start. Use the Homework button to hide fast.</div>
      <div id="gameContent" style="margin-top:12px"></div>
    </div>

  </section>

  <section class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:900">Notes & Quick Links</div>
      <div class="muted">Saved locally</div>
    </div>
    <div style="margin-top:8px">
      <textarea id="notes" placeholder="Quick study notes..."></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="saveNotes" class="btn btn-primary">Save Notes</button>
        <button id="clearNotes" class="btn btn-ghost">Clear</button>
      </div>
    </div>
  </section>

</main>

<!-- Hidden homework screen (fast hide) -->
<div id="homeworkOverlay" class="hidden" style="position:fixed;inset:10px;background:#fff;z-index:60;border-radius:12px;padding:18px;box-shadow:0 12px 40px rgba(11,17,32,0.12);overflow:auto">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <div><div style="font-weight:900">Homework — Math</div><div class="muted">Classwork • Show your work</div></div>
    <div><button id="closeHomework" class="btn btn-ghost">Close</button></div>
  </div>
  <div style="margin-top:14px">
    <p><strong>Task 1:</strong> Solve the equation: 3x + 5 = 23. Show steps.</p>
    <p><strong>Task 2:</strong> Rewrite the sentence: "The scientific method is important."</p>
    <p><strong>Notes:</strong></p>
    <textarea style="width:100%;min-height:300px;border-radius:8px;padding:10px"></textarea>
  </div>
</div>

<footer>Greenfield High • Practice Tools • Built for personal use</footer>

<!-- Audio element (no src by default) -->
<audio id="bgAudio" loop></audio>

<script>
/* ======= Unlock & UI ======= */
const logo = document.getElementById('logo');
let taps = 0, timer=null;
logo.addEventListener('click', ()=> {
  taps++;
  if(timer) clearTimeout(timer);
  timer = setTimeout(()=> taps = 0, 1400);
  if(taps >= 3){
    taps = 0;
    localStorage.setItem('gf_unlocked','1');
    document.getElementById('gamesPanel').style.display = 'block';
    alert('Practice Tools unlocked ✅');
  }
});
if(localStorage.getItem('gf_unlocked') === '1') document.getElementById('gamesPanel').style.display = 'block';

/* ======= Notes ======= */
const notesEl = document.getElementById('notes');
notesEl.value = localStorage.getItem('gf_notes') || '';
document.getElementById('saveNotes').onclick = ()=> { localStorage.setItem('gf_notes', notesEl.value); alert('Notes saved'); };
document.getElementById('clearNotes').onclick = ()=> { if(confirm('Clear notes?')) { notesEl.value=''; localStorage.removeItem('gf_notes'); } };

/* ======= Music upload & controls (user supplies file) ======= */
const musicInput = document.getElementById('musicFile');
const uploadBtn = document.getElementById('uploadMusic');
const musicToggle = document.getElementById('musicToggle');
const audio = document.getElementById('bgAudio');

uploadBtn.addEventListener('click', ()=> musicInput.click());
musicInput.addEventListener('change', (e)=>{
  const f = e.target.files[0];
  if(!f) return;
  const url = URL.createObjectURL(f);
  audio.src = url;
  musicToggle.classList.remove('hidden');
  musicToggle.textContent = 'Play Music';
  localStorage.setItem('gf_music', url); // note: object URL persists only in session; we keep it to show toggle
  alert('Music uploaded — press Play');
});
musicToggle.addEventListener('click', ()=>{
  if(audio.paused){ audio.play().catch(()=>alert('Tap on the page to enable audio (Safari)').then); musicToggle.textContent = 'Pause Music'; }
  else { audio.pause(); musicToggle.textContent = 'Play Music'; }
});

/* ======= Search filter ======= */
const searchBox = document.getElementById('searchBox');
const searchClear = document.getElementById('searchClear');
searchBox.addEventListener('input', ()=> filterGames(searchBox.value));
searchClear.addEventListener('click', ()=> { searchBox.value=''; filterGames(''); });

function filterGames(q){
  q = q.trim().toLowerCase();
  document.querySelectorAll('#gamesGrid .game-tile').forEach(tile=>{
    const name = tile.querySelector('.game-name').textContent.toLowerCase();
    const url = (tile.dataset.url || '').toLowerCase();
    tile.style.display = (name.includes(q) || url.includes(q) || q==='') ? '' : 'none';
  });
}

/* ======= Homework hide ======= */
const homeworkBtn = document.getElementById('homeworkBtn');
const homeworkOverlay = document.getElementById('homeworkOverlay');
document.getElementById('closeHomework').addEventListener('click', ()=> homeworkOverlay.classList.add('hidden'));
homeworkBtn.addEventListener('click', ()=> {
  homeworkOverlay.classList.remove('hidden');
});

/* ======= Games wiring: open poki links inside iframe ======= */
const gameTiles = document.querySelectorAll('.game-tile');
const gameContent = document.getElementById('gameContent');
const playArea = document.getElementById('playArea');
const playTitle = document.getElementById('playTitle');
const closeGame = document.getElementById('closeGame');

gameTiles.forEach(t => t.addEventListener('click', ()=>{
  const url = t.dataset.url;
  openGameInFrame(url, t.querySelector('.game-name').textContent);
}));

closeGame.addEventListener('click', ()=> {
  stopGameFrame();
  playArea.style.display = 'none';
  playTitle.textContent = 'Ready';
  gameContent.innerHTML = '';
});

function openGameInFrame(url, title){
  // show play area and insert iframe
  playArea.style.display = 'block';
  playTitle.textContent = title;
  // Some game sites block embedding via frame; try to use poki embed wrapper if possible
  // We'll attempt direct URL first
  const iframe = document.createElement('iframe');
  iframe.className = 'gameFrame';
  iframe.src = url;
  iframe.loading = 'lazy';
  // clear and append
  gameContent.innerHTML = '';
  gameContent.appendChild(iframe);
}

/* stop game: remove iframe / revoke object urls */
function stopGameFrame(){
  const iframe = gameContent.querySelector('iframe');
  if(iframe){
    iframe.src = 'about:blank';
    iframe.remove();
  }
  // pause audio
  if(!audio.paused) { audio.pause(); musicToggle.textContent='Play Music'; }
}

/* small safety: pause audio on hide/pagehide */
window.addEventListener('pagehide', ()=> { try { audio.pause(); stopGameFrame(); } catch(e){} });

/* If user wants quick hide: hideGames button rapidly hides panels */
document.getElementById('hideGames').addEventListener('click', ()=> {
  stopGameFrame();
  document.getElementById('gamesPanel').style.display = 'none';
  playArea.style.display = 'none';
  homeworkOverlay.classList.add('hidden');
});

/* helpful tip: keyboard toggle for music */
document.addEventListener('keydown', e => {
  if(e.key === 'm') {
    if(audio.src) { if(audio.paused) audio.play(); else audio.pause(); }
  }
});
</script>
</body>
</html>
